import subprocess
from concurrent.futures import ThreadPoolExecutor
import os

# âš™ï¸ Cáº¥u hÃ¬nh
target_ip = "1.2.3.4"  # Äá»•i thÃ nh IP cá»§a báº¡n
step = 1000            # Má»—i dáº£i 1000 cá»•ng
output_dir = "nmap_results"

# ğŸ“ Táº¡o thÆ° má»¥c káº¿t quáº£
os.makedirs(output_dir, exist_ok=True)

# ğŸ“¦ HÃ m quÃ©t 1 dáº£i cá»•ng
def run_nmap(start_port, end_port):
    output_file = os.path.join(output_dir, f"nmap_{start_port}_{end_port}.txt")
    command = [
        "nmap", "-sC", "-sV",
        "-p", f"{start_port}-{end_port}",
        target_ip,
        "-oN", output_file
    ]
    print(f"[+] Scanning ports {start_port}-{end_port}")
    subprocess.run(command, stdout=subprocess.DEVNULL)
    print(f"[âœ“] Done ports {start_port}-{end_port}")

# ğŸ§µ Cháº¡y song song
with ThreadPoolExecutor(max_workers=10) as executor:  # CÃ³ thá»ƒ chá»‰nh max_workers
    for start in range(1, 65536, step):
        end = min(start + step - 1, 65535)
        executor.submit(run_nmap, start, end)

print("ğŸ”¥ All scans submitted.")
