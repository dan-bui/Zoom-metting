
import base64
import hashlib

# Chu·ªói hash t·ª´ file b·∫°n g·ª≠i
hash_str = "{PKCS5S2}ueMu+nTGBtFeGXGBLXXFcJLdSF4uVkZxMQ1Bst8wm3uhZcDs56a2ProZiS0k2hv"

# B·ªè ph·∫ßn ti·ªÅn t·ªë
encoded_data = hash_str.replace("{PKCS5S2}", "")

# Gi·∫£i m√£ base64
decoded = base64.b64decode(encoded_data)

# Gi·∫£ s·ª≠ c·∫•u tr√∫c:
#   - 16 byte salt
#   - ph·∫ßn c√≤n l·∫°i l√† derived key
salt = decoded[:16]
stored_hash = decoded[16:]

# PBKDF2 config ‚Äì c·∫ßn ƒëo√°n ho·∫∑c bi·∫øt:
iterations = 1000  # th·ª≠ 1000 tr∆∞·ªõc, t√πy app c√≥ th·ªÉ l√† 10k ho·∫∑c 65k...
dk_len = len(stored_hash)  # ƒë·ªô d√†i hash c·∫ßn sinh ra
algo = 'sha1'  # ho·∫∑c 'sha256' n·∫øu b·∫°n bi·∫øt ch√≠nh x√°c h·ªá th·ªëng d√πng c√°i g√¨

# ‚úÖ Test password
def check_password(password):
    derived = hashlib.pbkdf2_hmac(algo, password.encode(), salt, iterations, dklen=dk_len)
    return derived == stored_hash

# üìÇ Th·ª≠ brute-force b·∫±ng wordlist
with open("wordlist.txt", "r") as f:
    for line in f:
        pwd = line.strip()
        if check_password(pwd):
            print(f"[‚úÖ] Found password: {pwd}")
            break
    else:
        print("‚ùå Not found in wordlist.")
